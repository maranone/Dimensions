<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dimensions and Affinity</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
        }

        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }

        .slider-value {
            display: inline-block;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <!-- Display the content of the "description.txt" file -->
    <div id="fileContent"></div>

    <!-- Sliders for each dimension in a table -->
    <table id="slidersTable"></table>

    <!-- Form in Javascript -->
    <form id="myForm">
    </form>

    <!-- List Box to select scenarios from the "scenarios" folder -->
    <select id="scenarioList" onchange="showScenarioInfo()">
    </select>

    <!-- Labels to display information of the selected scenario -->
    <div id="scenarioInfo">
    </div>

    <!-- Table to display "Dimensions," "My Weights," "Scenario Dimensions," and "Affinity" -->
    <table id="dimensionsTable">
        <tr>
            <th>Dimensions</th>
            <th>My Weights</th>
            <th>Scenario Dimensions</th>
            <th>Affinity</th>
        </tr>
        <tr id="dimensionsRow">
            <!-- This row will be dynamically populated based on the selected scenario -->
        </tr>
    </table>

    <script>
        function populateFileList() {
            var select = document.getElementById("scenarioList");
            select.innerHTML = "";

            // Fetch the content of the scenarios.txt file
            fetch("scenarios.txt")
                .then(response => response.text())
                .then(data => {
                    // Split the text into an array using newline as a delimiter
                    var scenarios = data.split('\n');

                    // Iterate through the array and add each scenario title as an option to the select element
                    scenarios.forEach(scenario => {
                        var option = document.createElement("option");
                        var scenarioParts = scenario.split(';');
                        option.value = scenarioParts[0].trim();  // Use the title as the value
                        option.text = scenarioParts[0].trim();   // Display the title in the dropdown
                        select.add(option);
                    });
                })
                .catch(error => console.error("Error fetching scenario list:", error));

            // Fetch the content of the description.txt file and display it
            fetch("description.txt")
                .then(response => response.text())
                .then(data => {
                    document.getElementById("fileContent").innerText = data;
                })
                .catch(error => console.error("Error fetching description:", error));
        }

        function createSlidersTable(lines) {
            var slidersTable = document.getElementById("slidersTable");
            var dimensionsRow = document.getElementById("dimensionsRow");

            // Clear existing content
            dimensionsRow.innerHTML = "";

            // Add "Dimensions," "My Weights," "Scenario Dimensions," and "Affinity" headers
            var headers = ["Dimensions", "My Weights", "Scenario Dimensions", "Affinity"];
            headers.forEach(headerText => {
                var th = document.createElement("th");
                th.innerText = headerText;
                dimensionsRow.appendChild(th);
            });

            lines.forEach(line => {
                // Skip empty lines
                if (line.trim() === "") {
                    return;
                }

                // Split line into dimension and description
                var [dimension, description] = line.split(":").map(str => str.trim());

                // Create a label for each dimension
                var label = document.createElement("label");
                label.innerText = dimension;

                // Create a slider for each dimension
                var slider = document.createElement("input");
                slider.type = "range";
                slider.min = -5;
                slider.max = 5;
                slider.disabled = true;  // Disable the slider

                // Create a span to display the current selected value
                var valueSpan = document.createElement("span");
                valueSpan.className = "slider-value";
                valueSpan.innerText = slider.value;

                // Append the label, slider, and value span to the row
                dimensionsRow.appendChild(label);
                dimensionsRow.appendChild(slider);
                dimensionsRow.appendChild(valueSpan);
            });
        }

        function showScenarioInfo() {
            var selectedScenario = document.getElementById("scenarioList").value;

            // Fetch the content of the scenarios.txt file
            fetch("scenarios.txt")
                .then(response => response.text())
                .then(data => {
                    var scenarios = data.split('\n');

                    // Find the selected scenario in the array
                    var selectedScenarioData = scenarios.find(scenario => scenario.startsWith(selectedScenario));

                    // Populate the "Scenario Dimensions" column in the table
                    var scenarioParts = selectedScenarioData.split(';');
                    var scenarioDimensions = scenarioParts.slice(2);
                    var slidersTable = document.getElementById("slidersTable");

                    for (var i = 0; i < slidersTable.rows[0].cells.length; i++) {
                        // Update the value span with the scenario's dimension weight
                        slidersTable.rows[0].cells[i].getElementsByTagName("span")[0].innerText = scenarioDimensions[i];
                    }
                })
                .catch(error => console.error("Error fetching scenario details:", error));

            // Calculate and update the "Affinity" column (currently a placeholder)
            calculateAffinity();
        }

        function calculateAffinity() {
            var affinityElement = document.getElementById("affinity");

            if (!affinityElement) {
                console.error("Element with id 'affinity' not found");
                return;
            }
            // Implement the logic to calculate affinity based on default and amended dimensions
            // This can be done by retrieving values from sliders and applying your formula
            // For now, leave it blank until you finalize the formula.
            document.getElementById("affinity").innerText = "To be calculated";
        }

        function populateDimensionsTable() {
            var select = document.getElementById("scenarioList");
            var defaultDimensions = select.options[select.selectedIndex].value;

            if (!select) {
                console.error("Element with id 'scenarioList' not found");
                return;
            }
            // Fetch the content of the description.txt file and display it
            fetch("description.txt")
                .then(response => response.text())
                .then(data => {
                    document.getElementById("fileContent").innerText = data;
                })
                .catch(error => console.error("Error fetching description:", error));

            // Fetch the content of the description.txt file
            fetch("description.txt")
                .then(response => response.text())
                .then(data => {
                    // Split the text into an array using newline as a delimiter
                    var lines = data.split('\n');

                    // Populate the sliders table with the dimensions
                    createSlidersTable(lines);
                })
                .catch(error => console.error("Error fetching dimensions:", error));
        }

        populateFileList();
        populateDimensionsTable();
    </script>
</body>
</html>

